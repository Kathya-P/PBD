<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cuestionario SQL Server</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="hero">
    <div class="hero-content">
      <p class="tag">SQL Server Â· Laboratorio</p>
      <h1>Cuestionario de Programacion de Bases de Datos</h1>
      <p class="subtitle">Teoria + Practica con ejercicios abiertos. Guarda tus respuestas y compara con la correcta.</p>
      <div class="hero-meta">
        <span>DDL</span>
        <span>DML</span>
        <span>Consultas</span>
        <span>Integridad</span>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="panel" aria-labelledby="config-title">
      <div class="panel-header">
        <h2 id="config-title">Configurar practica</h2>
        <button id="shuffleBtn" class="ghost">Mezclar preguntas</button>
      </div>
      <div class="panel-body grid">
        <div class="field">
          <label for="sectionSelect">Seccion</label>
          <select id="sectionSelect">
            <option value="all">Todas</option>
            <option value="Teoria" selected>Teoria</option>
            <option value="Practica">Practica</option>
            <option value="Practica Consultas">Practica Consultas</option>
            <option value="Guia">Guia de Practicas</option>
          </select>
        </div>
        <div class="field">
          <label for="topicSelect">Tema</label>
          <select id="topicSelect">
            <option value="all">Todos</option>
          </select>
        </div>
        <div class="field">
          <label for="difficultySelect">Dificultad</label>
          <select id="difficultySelect">
            <option value="all">Todas</option>
            <option value="basico">Basico</option>
            <option value="medio" selected>Medio</option>
            <option value="avanzado">Avanzado</option>
          </select>
        </div>
        <div class="field">
          <label for="countSelect">Cantidad</label>
          <select id="countSelect">
            <option value="all">Todas</option>
            <option value="8">8</option>
            <option value="12" selected>12</option>
            <option value="16">16</option>
            <option value="20">20</option>
          </select>
        </div>
      </div>
    </section>

    <section class="panel" aria-labelledby="quiz-title">
      <div class="panel-header">
        <h2 id="quiz-title">Ejercicios</h2>
        <div class="progress" aria-live="polite">
          <span id="progressText">Pregunta 1 de 1</span>
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill"></div>
          </div>
        </div>
      </div>
      <div class="panel-body">
        <article id="questionCard" class="question"></article>
        <div id="feedback" class="feedback" aria-live="polite"></div>
        <div class="actions">
          <button id="checkBtn" class="primary">Revisar respuesta</button>
          <button id="nextBtn" class="secondary" disabled>Siguiente</button>
          <button id="answerBtn" class="ghost">Ver respuesta</button>
        </div>
      </div>
    </section>

    <section class="panel" aria-labelledby="summary-title" id="summary" hidden>
      <div class="panel-header">
        <h2 id="summary-title">Resumen</h2>
        <button id="restartBtn" class="primary">Reiniciar practica</button>
      </div>
      <div class="panel-body">
        <div class="summary-grid">
          <div>
            <p class="label">Completadas</p>
            <p id="scoreText" class="score">0/0</p>
          </div>
          <div>
            <p class="label">Temas pendientes</p>
            <ul id="weakTopics" class="weak-list"></ul>
          </div>
        </div>
        <div>
          <h3>Consejos</h3>
          <ul class="recommendations">
            <li>Guarda tus scripts en una carpeta por tema (DDL, DML, Consultas).</li>
            <li>Incluye datos de prueba coherentes antes de escribir consultas.</li>
            <li>Si te bloqueas, usa la pista y reintenta sin copiar soluciones.</li>
          </ul>
        </div>
      </div>
    </section>

              <section class="panel" aria-labelledby="study-title" id="study-guide" hidden>
                <div class="panel-header">
            <h2 id="study-title">Guia de Practicas (todas las consultas explicadas)</h2>
                </div>
                <div class="panel-body">
            <p class="subtitle">Incluye todas las consultas de las 4 guias con explicacion breve.</p>

            <h3>Practica 01 - Parte 1 (BD_GrupoComercial_SV)</h3>
            <pre class="code-block">-- Crear base de datos
          CREATE DATABASE BD_GrupoComercial_SV;</pre>
            <p class="note">Explicacion: crea la base de datos principal.</p>

            <pre class="code-block">-- Crear tabla Clientes
          CREATE TABLE Clientes (
            IdCliente INT IDENTITY(1,1) PRIMARY KEY,
            Nombres VARCHAR(150) NOT NULL,
            Apellidos VARCHAR(150) NOT NULL,
            DUI VARCHAR(10) NOT NULL,
            Email VARCHAR(250) NOT NULL,
            FechaRegistro DATETIME NOT NULL
          );</pre>
            <p class="note">Explicacion: define campos y clave primaria.</p>

            <pre class="code-block">-- Restricciones de Clientes
          ALTER TABLE Clientes ADD CONSTRAINT UQ_DUI UNIQUE (DUI);
          ALTER TABLE Clientes ADD CONSTRAINT Check_email CHECK (Email LIKE '%@%.%');
          ALTER TABLE Clientes ADD CONSTRAINT DEF_fecha DEFAULT GETDATE() FOR FechaRegistro;</pre>
            <p class="note">Explicacion: evita duplicados, valida email y agrega valor por defecto.</p>

            <pre class="code-block">-- Tabla Ventas y FK con Clientes
          CREATE TABLE Ventas (
            IdVenta INT IDENTITY(1,1) PRIMARY KEY,
            IdCliente INT NOT NULL,
            FechaVenta DATETIME NOT NULL,
            TotalVenta DECIMAL(10,2) NOT NULL,
            CONSTRAINT FK_Ventas_Clientes FOREIGN KEY (IdCliente) REFERENCES Clientes(IdCliente)
          );</pre>
            <p class="note">Explicacion: crea ventas con integridad referencial.</p>

            <pre class="code-block">-- Modificar Clientes
          ALTER TABLE Clientes ADD Telefono VARCHAR(20) NOT NULL;
          ALTER TABLE Clientes ALTER COLUMN Email VARCHAR(150) NOT NULL;
          ALTER TABLE Clientes ADD CONSTRAINT check_telefono CHECK (Telefono LIKE '[0-9]%');</pre>
            <p class="note">Explicacion: agrega telefono, ajusta email y valida formato.</p>

            <pre class="code-block">-- Tabla temporal y control de eliminacion
          CREATE TABLE TablaTemp (Id INT IDENTITY(1,1), Descripcion VARCHAR(250));
          INSERT INTO TablaTemp (Descripcion) VALUES ('Registro de prueba 1');
          INSERT INTO TablaTemp (Descripcion) VALUES ('Segundo registro de prueba');
          INSERT INTO TablaTemp (Descripcion) VALUES ('Ultimo registro para probar');
          TRUNCATE TABLE TablaTemp;
          INSERT INTO TablaTemp (Descripcion) VALUES ('Registro despues del truncate');
          DROP TABLE TablaTemp;</pre>
            <p class="note">Explicacion: diferencia TRUNCATE vs DROP.</p>

            <pre class="code-block">-- Tablas Empleados y Productos + PK
          CREATE TABLE Empleados (
            IdEmpleado INT IDENTITY(1,1) NOT NULL,
            Nombres VARCHAR(150) NOT NULL,
            Apellidos VARCHAR(150) NOT NULL,
            DUI VARCHAR(10) NOT NULL,
            Email VARCHAR(250) NOT NULL,
            Cargo VARCHAR(50) NOT NULL,
            FechaContratacion DATE NOT NULL
          );
          CREATE TABLE Productos (
            IdProducto INT IDENTITY(1,1) NOT NULL,
            NombreProducto VARCHAR(150) NOT NULL,
            Precio DECIMAL(10,2) NOT NULL,
            Stock INT NOT NULL
          );
          ALTER TABLE Empleados ADD CONSTRAINT PK_Empleados PRIMARY KEY (IdEmpleado);
          ALTER TABLE Productos ADD CONSTRAINT PK_Productos PRIMARY KEY (IdProducto);</pre>
            <p class="note">Explicacion: crea entidades y define PKs.</p>

            <pre class="code-block">-- Relacionar Ventas con Empleados y Productos
          ALTER TABLE Ventas ADD IdEmpleado INT NOT NULL;
          ALTER TABLE Ventas ADD IdProducto INT NOT NULL;
          ALTER TABLE Ventas ADD CONSTRAINT FK_Ventas_Empleados FOREIGN KEY (IdEmpleado) REFERENCES Empleados(IdEmpleado);
          ALTER TABLE Ventas ADD CONSTRAINT FK_Ventas_Productos FOREIGN KEY (IdProducto) REFERENCES Productos(IdProducto);</pre>
            <p class="note">Explicacion: agrega FKs adicionales.</p>

            <pre class="code-block">-- Consultas simples
          SELECT * FROM Ventas;
          USE BD_GrupoComercial_SV;
          SELECT * FROM Clientes;</pre>
            <p class="note">Explicacion: verifica datos creados.</p>

            <h3>Practica 01 - Caso 2 (TecnoService)</h3>
            <pre class="code-block">-- Crear BD y tablas base
          CREATE DATABASE BD_TecnoService_SV;
          USE BD_TecnoService_SV;
          CREATE TABLE Clientes (
            IdCliente INT IDENTITY(1,1) PRIMARY KEY,
            Nombres VARCHAR(150) NOT NULL,
            Apellidos VARCHAR(150) NOT NULL,
            DUI VARCHAR(10) NOT NULL,
            Telefono VARCHAR(20) NOT NULL,
            Email VARCHAR(150) NOT NULL,
            Direccion VARCHAR(250) NOT NULL,
            FechaRegistro DATETIME NOT NULL
          );
          CREATE TABLE Tecnicos (
            IdTecnico INT IDENTITY(1,1) PRIMARY KEY,
            Nombres VARCHAR(150) NOT NULL,
            Apellidos VARCHAR(150) NOT NULL,
            DUI VARCHAR(10) NOT NULL,
            Telefono VARCHAR(20) NOT NULL,
            Email VARCHAR(150) NOT NULL,
            Area VARCHAR(100) NOT NULL,
            FechaContratacion DATE NOT NULL
          );
          CREATE TABLE Estados (
            IdEstado INT IDENTITY(1,1) PRIMARY KEY,
            NombreEstado VARCHAR(100) NOT NULL,
            Descripcion VARCHAR(200) NULL
          );
          CREATE TABLE OrdenesTrabajos (
            IdOrden INT IDENTITY(1,1) PRIMARY KEY,
            IdCliente INT NOT NULL,
            IdTecnico INT NOT NULL,
            IdEstado INT NOT NULL,
            FechaCreacion DATETIME NOT NULL,
            DescripcionProblema VARCHAR(250) NOT NULL,
            Costo DECIMAL(10,2) NOT NULL
          );</pre>
            <p class="note">Explicacion: estructura del caso TecnoService.</p>

            <pre class="code-block">-- Restricciones y FKs
          ALTER TABLE Clientes ADD CONSTRAINT UQ_DUI UNIQUE (DUI);
          ALTER TABLE Clientes ADD CONSTRAINT Check_Email CHECK (Email LIKE '%@%.%');
          ALTER TABLE Clientes ADD CONSTRAINT DF_FechaRegistro DEFAULT GETDATE() FOR FechaRegistro;
          ALTER TABLE Tecnicos ADD CONSTRAINT UQ_DUI UNIQUE (DUI);
          ALTER TABLE Tecnicos ADD CONSTRAINT Check_Email CHECK (Email LIKE '%@%.%');
          ALTER TABLE OrdenesTrabajos ADD CONSTRAINT Check_Costo CHECK (Costo >= 0);
          ALTER TABLE OrdenesTrabajos ADD CONSTRAINT DF_FechaCreacion DEFAULT GETDATE() FOR FechaCreacion;
          ALTER TABLE OrdenesTrabajos ADD CONSTRAINT FK_Ordenes_Clientes FOREIGN KEY (IdCliente) REFERENCES Clientes(IdCliente);
          ALTER TABLE OrdenesTrabajos ADD CONSTRAINT FK_Ordenes_Tecnicos FOREIGN KEY (IdTecnico) REFERENCES Tecnicos(IdTecnico);
          ALTER TABLE OrdenesTrabajos ADD CONSTRAINT FK_Ordenes_Estados FOREIGN KEY (IdEstado) REFERENCES Estados(IdEstado);</pre>
            <p class="note">Explicacion: validaciones y relaciones del caso.</p>

            <h3>Practica 02 (DetalleVentas y datos reales)</h3>
            <pre class="code-block">-- Preparacion del entorno
          USE BD_GrupoComercial_SV;
          ALTER TABLE Empleados ADD Salario DECIMAL(10,2) NOT NULL;</pre>
            <p class="note">Explicacion: agrega salario al esquema.</p>

            <pre class="code-block">-- Crear DetalleVentas
          CREATE TABLE DetalleVentas (
            IdDetalleVenta INT IDENTITY(1,1) PRIMARY KEY,
            IdVenta INT NOT NULL,
            IdProducto INT NOT NULL,
            Cantidad INT NOT NULL,
            CONSTRAINT FK_Ventas_Detalle FOREIGN KEY (IdVenta) REFERENCES Ventas(IdVenta),
            CONSTRAINT FK_Producto_Detalle FOREIGN KEY (IdProducto) REFERENCES Productos(IdProducto)
          );</pre>
            <p class="note">Explicacion: tabla puente para relacion N:N.</p>

            <pre class="code-block">-- Insertar 4 clientes
          INSERT INTO Clientes (Nombres, Apellidos, DUI, Email, FechaRegistro, Telefono)
          VALUES
          ('Daniela Carolina', 'Monge Cartagena', '01234567-8', 'danielamonge@gmail.com', '2024-01-10', '1234-5678'),
          ('Justin Oswaldo', 'Ramirez Lemus', '56234567-1', 'justin@gmail.com', '2024-03-04', '8344-6489'),
          ('Jimmy Fernando', 'Carcamo Mejia', '73544567-3', 'jimmy@gmail.com', '2024-07-05', '3456-6473'),
          ('Marlin Yolanda', 'Afane Vasquez', '74368234-5', 'marlin@gmail.com', '2024-08-05', '4563-3489');</pre>
            <p class="note">Explicacion: datos reales para pruebas.</p>

            <pre class="code-block">-- Insertar 6 productos
          INSERT INTO Productos (NombreProducto, Precio, Stock)
          VALUES
          ('Computadora', 500, 50),
          ('Tablet', 300, 600),
          ('Laptop', 1000, 700),
          ('Audifonos', 30, 200),
          ('Celular', 350, 300),
          ('Teclado', 40, 100);</pre>
            <p class="note">Explicacion: inventario base.</p>

            <pre class="code-block">-- Insertar 3 empleados
          INSERT INTO Empleados (Nombres, Apellidos, DUI, Email, Cargo, FechaContratacion, Salario)
          VALUES
          ('Bayron Adriel', 'Meneses Gomez', '01234567-8', 'bayron@gmail.com', 'Analista de credito', '2022-02-15', 600.50),
          ('Kathya Carolina', 'Perez Jimenez', '75934567-6', 'kathya@gmail.com', 'Recursos Humanos', '2020-12-05', 800.30),
          ('Carlos Ernesto', 'Gomez Gonzales', '34567892-5', 'carlos@gmail.com', 'Cobrador', '2024-07-05', 408.20);</pre>
            <p class="note">Explicacion: empleados reales con salarios.</p>

            <pre class="code-block">-- Registrar 10 ventas
          INSERT INTO Ventas
          VALUES
          (11, 1, 2, '2026-01-10'),
          (12, 1, 4, '2026-04-12'),
          (13, 1, 5, '2026-06-11'),
          (14, 2, 2, '2026-10-10'),
          (13, 2, 5, '2026-06-11'),
          (12, 2, 4, '2026-04-12'),
          (13, 3, 5, '2026-08-07'),
          (11, 3, 3, '2026-11-03'),
          (13, 3, 5, '2026-05-04'),
          (12, 1, 1, '2026-06-06');</pre>
            <p class="note">Explicacion: ventas distribuidas en fechas.</p>

            <pre class="code-block">-- Consultas de Practica 02
          SELECT * FROM Clientes WHERE MONTH(FechaRegistro) = 2;
          SELECT * FROM Productos WHERE Stock &lt; 10;
          SELECT * FROM Ventas WHERE IdEmpleado = (
            SELECT IdEmpleado FROM Empleados WHERE FechaContratacion =
            (SELECT MIN(FechaContratacion) FROM Empleados WHERE Cargo = 'Vendedor')
          );
          SELECT * FROM Clientes WHERE FechaRegistro = (SELECT MAX(FechaRegistro) FROM Clientes);</pre>
            <p class="note">Explicacion: consultas de decision basadas en fechas y stock.</p>

            <pre class="code-block">-- Correccion y mantenimiento
          UPDATE Clientes SET Telefono = '6785-4567' WHERE IdCliente = 12;
          UPDATE Productos SET Precio = 500 WHERE Stock = 0;
          UPDATE Empleados SET Salario = Salario * 1.10
          WHERE DATEDIFF(YEAR, FechaContratacion, GETDATE()) &gt; 1;
          DELETE FROM Clientes WHERE IdCliente NOT IN (SELECT DISTINCT IdCliente FROM Ventas);
          DELETE FROM Productos WHERE IdProducto NOT IN (SELECT DISTINCT IdProducto FROM Ventas);</pre>
            <p class="note">Explicacion: mantenimiento y depuracion de datos.</p>

            <h3>Practica 03 (Consultas de negocio)</h3>
            <pre class="code-block">-- Preparacion y ajuste de tabla Ventas
          USE BD_GrupoComercial_SV;
          ALTER TABLE Ventas DROP CONSTRAINT FK_Ventas_Productos;
          ALTER TABLE Ventas DROP COLUMN IdProducto;</pre>
            <p class="note">Explicacion: elimina columna y FK en Ventas.</p>

            <pre class="code-block">-- Insertar detalle de ventas (3 productos por venta)
          INSERT INTO DetalleVentas (IdVenta, IdProducto, Cantidad)
          VALUES
          (1, 1, 2),(1, 3, 1),(1, 5, 3),
          (2, 2, 1),(2, 4, 5),(2, 6, 2),
          (3, 1, 1),(3, 2, 2),(3, 3, 1),
          (4, 4, 3),(4, 5, 2),(4, 6, 4),
          (5, 1, 2),(5, 3, 1),(5, 4, 2),
          (6, 2, 3),(6, 5, 1),(6, 6, 2),
          (7, 1, 1),(7, 2, 2),(7, 3, 3),
          (8, 4, 2),(8, 5, 1),(8, 6, 3),
          (9, 1, 4),(9, 3, 2),(9, 4, 1),
          (10, 2, 1),(10, 5, 3),(10, 6, 2);</pre>
            <p class="note">Explicacion: datos para consultas de negocio.</p>

            <pre class="code-block">-- a) Ventas del vendedor mas antiguo
          SELECT * FROM Ventas WHERE IdEmpleado = (
            SELECT TOP 1 IdEmpleado FROM Empleados
            WHERE Cargo = 'Vendedor'
            ORDER BY FechaContratacion ASC
          );

          -- b) Total comprado por ultimo cliente registrado
          SELECT C.IdCliente, C.Nombres, C.Apellidos,
                 SUM(P.Precio * DV.Cantidad) AS TotalComprado
          FROM Clientes C
          JOIN Ventas V ON C.IdCliente = V.IdCliente
          JOIN DetalleVentas DV ON V.IdVenta = DV.IdVenta
          JOIN Productos P ON DV.IdProducto = P.IdProducto
          WHERE C.FechaRegistro = (SELECT MAX(FechaRegistro) FROM Clientes)
          GROUP BY C.IdCliente, C.Nombres, C.Apellidos;

          -- c) Productos mas vendidos
          SELECT IdProducto, SUM(Cantidad) AS Total
          FROM DetalleVentas
          GROUP BY IdProducto ORDER BY Total DESC;

          -- d) Ranking de vendedores
          SELECT E.Nombres, E.Apellidos, COUNT(V.IdVenta) AS TotalVentas
          FROM Empleados E
          JOIN Ventas V ON E.IdEmpleado = V.IdEmpleado
          GROUP BY E.Nombres, E.Apellidos ORDER BY TotalVentas DESC;

          -- e) Ranking de clientes
          SELECT C.Nombres, C.Apellidos, COUNT(V.IdVenta) AS TotalCompras
          FROM Clientes C
          JOIN Ventas V ON C.IdCliente = V.IdCliente
          GROUP BY C.Nombres, C.Apellidos ORDER BY TotalCompras DESC;

          -- f) Top 3 clientes por valor comprado
          SELECT TOP 3 C.Nombres, C.Apellidos,
                 SUM(P.Precio * DV.Cantidad) AS TotalComprado
          FROM Clientes C
          JOIN Ventas V ON C.IdCliente = V.IdCliente
          JOIN DetalleVentas DV ON V.IdVenta = DV.IdVenta
          JOIN Productos P ON DV.IdProducto = P.IdProducto
          GROUP BY C.Nombres, C.Apellidos ORDER BY TotalComprado DESC;

          -- g) Ingresos por mes
          SELECT MONTH(V.FechaVenta) AS Mes,
                 SUM(P.Precio * DV.Cantidad) AS Ingresos
          FROM Ventas V
          JOIN DetalleVentas DV ON V.IdVenta = DV.IdVenta
          JOIN Productos P ON DV.IdProducto = P.IdProducto
          GROUP BY MONTH(V.FechaVenta) ORDER BY Mes;

          -- h) Productos con precio mayor al promedio
          SELECT * FROM Productos
          WHERE Precio &gt; (SELECT AVG(Precio) FROM Productos);

          -- i) Empleado con mas ventas
          SELECT TOP 1 E.Nombres, E.Apellidos, COUNT(V.IdVenta) AS TotalVentas
          FROM Empleados E
          JOIN Ventas V ON E.IdEmpleado = V.IdEmpleado
          GROUP BY E.Nombres, E.Apellidos ORDER BY TotalVentas DESC;

          -- j) Productos vendidos mas de 5 veces
          SELECT P.NombreProducto, SUM(DV.Cantidad) AS TotalVendido
          FROM Productos P
          JOIN DetalleVentas DV ON P.IdProducto = DV.IdProducto
          GROUP BY P.NombreProducto HAVING SUM(DV.Cantidad) &gt; 5;</pre>
            <p class="note">Explicacion: conjunto completo de consultas del negocio.</p>
                </div>
              </section>
  </main>

  <footer class="footer">
    <p>Listo para practicar en linea. Exporta tus scripts y subelos a GitHub.</p>
  </footer>

  <script src="questions.js?v=20260216" defer></script>
  <script src="app.js?v=20260216" defer></script>
</body>
</html>
